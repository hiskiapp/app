<!DOCTYPE html>
<html lang="en-US">

<head>
  <meta http-equiv="X-Clacks-Overhead" content="GNU Terry Pratchett" />
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="shortcut icon" href="https://kia0.pages.dev/images/favicon.png" />
<title>Backup and Restore PostgreSQL Database on CentOS 7 | Kia ʕ•ᴥ•ʔ</title>
<meta name="title" content="Backup and Restore PostgreSQL Database on CentOS 7" />
<meta name="description" content="Backup and Restore PostgreSQL Database on CentOS 7" />
<meta name="keywords" content="postgresql," />


<meta property="og:url" content="https://kia0.pages.dev/backup-and-restore-postgresql-database-on-centos-7/">
  <meta property="og:site_name" content="Kia ʕ•ᴥ•ʔ">
  <meta property="og:title" content="Backup and Restore PostgreSQL Database on CentOS 7">
  <meta property="og:description" content="Backup and Restore PostgreSQL Database on CentOS 7">
  <meta property="og:locale" content="en_US">
  <meta property="og:type" content="article">
    <meta property="article:section" content="blog">
    <meta property="article:published_time" content="2024-02-29T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-02-29T00:00:00+00:00">
    <meta property="article:tag" content="Postgresql">
    <meta property="og:image" content="https://kia0.pages.dev/images/share.png">




  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="https://kia0.pages.dev/images/share.png">
  <meta name="twitter:title" content="Backup and Restore PostgreSQL Database on CentOS 7">
  <meta name="twitter:description" content="Backup and Restore PostgreSQL Database on CentOS 7">




  <meta itemprop="name" content="Backup and Restore PostgreSQL Database on CentOS 7">
  <meta itemprop="description" content="Backup and Restore PostgreSQL Database on CentOS 7">
  <meta itemprop="datePublished" content="2024-02-29T00:00:00+00:00">
  <meta itemprop="dateModified" content="2024-02-29T00:00:00+00:00">
  <meta itemprop="wordCount" content="329">
  <meta itemprop="image" content="https://kia0.pages.dev/images/share.png">
  <meta itemprop="keywords" content="Postgresql">
<meta name="referrer" content="no-referrer-when-downgrade" />

  <style>
  body {
    font-family: Verdana, sans-serif;
    margin: auto;
    padding: 20px;
    max-width: 720px;
    text-align: left;
    background-color: #fff;
    word-wrap: break-word;
    overflow-wrap: break-word;
    line-height: 1.5;
    color: #444;
  }

  h1,
  h2,
  h3,
  h4,
  h5,
  h6,
  strong,
  b {
    color: #222;
  }

  a {
    color: #3273dc;
     
  }

  .title {
    text-decoration: none;
    border: 0;
  }

  .title span {
    font-weight: 400;
  }

  nav a {
    margin-right: 10px;
  }

  textarea {
    width: 100%;
    font-size: 16px;
  }

  input {
    font-size: 16px;
  }

  content {
    line-height: 1.6;
  }

  table {
    width: 100%;
  }

  img {
    max-width: 100%;
  }

  code {
    padding: 2px 5px;
    background-color: #f2f2f2;
  }

  pre code {
    color: #222;
    display: block;
    padding: 20px;
    white-space: pre-wrap;
    font-size: 14px;
    overflow-x: auto;
  }

  div.highlight pre {
    background-color: initial;
    color: initial;
  }

  div.highlight code {
    background-color: unset;
    color: unset;
  }

  blockquote {
    border-left: 1px solid #999;
    color: #222;
    padding-left: 20px;
    font-style: italic;
  }

  footer {
    padding: 25px;
    text-align: center;
  }

  .helptext {
    color: #777;
    font-size: small;
  }

  .errorlist {
    color: #eba613;
    font-size: small;
  }

   
  ul.blog-posts {
    list-style-type: none;
    padding: unset;
  }

  ul.blog-posts li {
    display: flex;
  }

  ul.blog-posts li span {
    flex: 0 0 130px;
  }

  ul.blog-posts li a:visited {
    color: #8b6fcb;
  }

  @media (prefers-color-scheme: dark) {
    body {
      background-color: #333;
      color: #ddd;
    }

    h1,
    h2,
    h3,
    h4,
    h5,
    h6,
    strong,
    b {
      color: #eee;
    }

    a {
      color: #8cc2dd;
    }

    code {
      background-color: #777;
    }

    pre code {
      color: #ddd;
    }

    blockquote {
      color: #ccc;
    }

    textarea,
    input {
      background-color: #252525;
      color: #ddd;
    }

    .helptext {
      color: #aaa;
    }
  }

</style>

</head>

<body>
  <header><a href="/" class="title">
  <h2>Kia ʕ•ᴥ•ʔ</h2>
</a>
<nav><a href="/">Home</a>


<a href="/blog">Blog</a>

</nav>
</header>
  <main>

<h1>Backup and Restore PostgreSQL Database on CentOS 7</h1>
<p>
  <i>
    <time datetime='2024-02-29' pubdate>
      29 Feb, 2024
    </time>
  </i>
</p>

<content>
  <p>Databases are crucial components of many systems and software. Thus, knowing how to backup and restore them becomes an essential skill. This article will guide you through the process of backing up and restoring a database in PostgreSQL on a CentOS 7 system.</p>
<h2 id="backup"><strong>Backup</strong></h2>
<p>The first step is to backup the database. In PostgreSQL, you can use the <code>pg_dump</code> command to achieve this. Here&rsquo;s an example of using this command:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>pg_dump -h 0.0.0.0 -p <span style="color:#ae81ff">5432</span> -U postgres -F c -b -v -f <span style="color:#e6db74">&#34;/usr/local/backup/db.dump&#34;</span> db -W
</span></span></code></pre></div><table>
<thead>
<tr>
<th>Command Option</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>-h</td>
<td>Specifies the host</td>
</tr>
<tr>
<td>-p</td>
<td>Specifies the port</td>
</tr>
<tr>
<td>-U</td>
<td>Specifies the user</td>
</tr>
<tr>
<td>-F c</td>
<td>Creates a custom-format archive</td>
</tr>
<tr>
<td>-b</td>
<td>Includes large objects in the dump</td>
</tr>
<tr>
<td>-v</td>
<td>Enables verbose mode</td>
</tr>
<tr>
<td>-f</td>
<td>Specifies the filename for the output</td>
</tr>
<tr>
<td>db</td>
<td>Indicates the name of the database to be dumped</td>
</tr>
<tr>
<td>-W</td>
<td>prompts for password</td>
</tr>
</tbody>
</table>
<p>Before executing this command, make sure the backup directory exists by running</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mkdir /usr/local/backup
</span></span></code></pre></div><h2 id="restore"><strong>Restore</strong></h2>
<p>Once the backup is complete, the next step is to restore it. The <code>pg_restore</code> command is used for this purpose. Here&rsquo;s an example of how to use it:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>pg_restore -d db -U postgres -C <span style="color:#e6db74">&#34;usr/local/backup/db.dump&#34;</span> -W
</span></span></code></pre></div><table>
<thead>
<tr>
<th>Command Option</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>-d</td>
<td>Specifies the database to restore</td>
</tr>
<tr>
<td>-U</td>
<td>Specifies the user</td>
</tr>
<tr>
<td>-C</td>
<td>Specifies the path to the dump file</td>
</tr>
<tr>
<td>-W</td>
<td>prompts for password</td>
</tr>
</tbody>
</table>
<p>This command instructs PostgreSQL to restore the database <code>db</code> using the user <code>postgres</code> and the dump file <code>db.dump</code>.</p>
<h2 id="troubleshooting"><strong>Troubleshooting</strong></h2>
<p>In case of encountering errors like <code>FATAL: Peer authentication failed for user &quot;postgres&quot;</code> or <code>FATAL: Indent authentication failed for user &quot;postgres&quot;</code>, the issue usually lies with the <code>pg_hba.conf</code> file.</p>
<p>To solve this, change <code>peer</code> or <code>indent</code> to <code>md5</code> in <code>pg_hba.conf</code>. Here&rsquo;s an example of how to do this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># &#34;local&#34; is for Unix domain socket connections only</span>
</span></span><span style="display:flex;"><span>local   all             all                                     md5
</span></span><span style="display:flex;"><span><span style="color:#75715e"># IPv4 local connections:</span>
</span></span><span style="display:flex;"><span>host    all             all             127.0.0.1/32            md5
</span></span></code></pre></div><p>The <code>pg_hba.conf</code> file is usually located in <code>/var/lib/pgsql/&lt;version&gt;/data/pg_hba.conf</code>.</p>
<p>By following these steps, you can effectively backup and restore your PostgreSQL databases on a CentOS 7 system.</p>

</content>
<p>
  
  <a href="https://kia0.pages.dev/blog/postgresql/">#Postgresql</a>
  
</p>

  </main>
  <footer>
</footer>

    
</body>

</html>
